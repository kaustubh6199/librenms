mib: MIKROTIK-MIB
modules:
    os:
        sysDescr_regex: '/RouterOS (?<hardware>.*)/'
        features: MIKROTIK-MIB::mtxrLicLevel.0
        features_template: 'Level {{ MIKROTIK-MIB::mtxrLicLevel.0 }}'
        serial: MIKROTIK-MIB::mtxrSerialNumber.0
        version: MIKROTIK-MIB::mtxrLicVersion.0
    sensors:
        pre-cache:
            data:
                -
                    oid:
                        - mtxrInterfaceStatsName
        temperature:
            data:
                -
                    oid: mtxrOpticalTable
                    value: mtxrOpticalTemperature
                    num_oid: '.1.3.6.1.4.1.14988.1.1.19.1.1.6.{{ $index }}'
                    descr: mtxrOpticalName
                    index: 'mtxrOpticalTemperature.{{ $index }}'
                -
                    oid: MIKROTIK-MIB::mtxrGaugeTable
                    value: MIKROTIK-MIB::mtxrGaugeValue
                    num_oid: '.1.3.6.1.4.1.14988.1.1.3.100.1.{{ $index }}'
                    descr: MIKROTIK-MIB::mtxrGaugeName
                    index: 'mtxrGaugeTemperature.{{ $index }}'
                    skip_values:
                        -   oid: MIKROTIK-MIB::mtxrGaugeUnit
                            op: '!='
                            value: 1
        voltage:
            data:
                -
                    oid: mtxrOpticalTable
                    value: mtxrOpticalSupplyVoltage
                    num_oid: '.1.3.6.1.4.1.14988.1.1.19.1.1.7.{{ $index }}'
                    divisor: 1000
                    descr: mtxrOpticalName
                    index: 'mtxrOpticalSupplyVoltage.{{ $index }}'
                -
                    oid: mtxrPOETable
                    value: mtxrPOEVoltage
                    num_oid: '.1.3.6.1.4.1.14988.1.1.15.1.1.4.{{ $index }}'
                    divisor: 10
                    descr: '{{ $mtxrPOEName }} POE'
                    index: 'mtxrPOEVoltage.{{ $index }}'
                -
                    oid: MIKROTIK-MIB::mtxrGaugeTable
                    value: MIKROTIK-MIB::mtxrGaugeValue
                    num_oid: '.1.3.6.1.4.1.14988.1.1.3.100.1.{{ $index }}'
                    descr: MIKROTIK-MIB::mtxrGaugeName
                    divisor: 10
                    index: 'mtxrGaugeVoltage.{{ $index }}'
                    skip_values:
                        -   oid: MIKROTIK-MIB::mtxrGaugeUnit
                            op: '!='
                            value: 3
        current:
            data:
                -
                    oid: mtxrOpticalTable
                    value: mtxrOpticalTxBiasCurrent
                    num_oid: '.1.3.6.1.4.1.14988.1.1.19.1.1.8.{{ $index }}'
                    divisor: 1000
                    descr: '{{ $mtxrOpticalName }} Tx'
                    index: 'mtxrOpticalTxBiasCurrent.{{ $index }}'
                -
                    oid: mtxrPOETable
                    value: mtxrPOECurrent
                    num_oid: '.1.3.6.1.4.1.14988.1.1.15.1.1.5.{{ $index }}'
                    divisor: 1000
                    descr: '{{ $mtxrPOEName }} POE'
                    index: 'mtxrPOECurrent.{{ $index }}'
                -
                    oid: MIKROTIK-MIB::mtxrGaugeTable
                    value: MIKROTIK-MIB::mtxrGaugeValue
                    num_oid: '.1.3.6.1.4.1.14988.1.1.3.100.1.{{ $index }}'
                    descr: MIKROTIK-MIB::mtxrGaugeName
                    divisor: 10
                    index: 'mtxrGaugeCurrent.{{ $index }}'
                    skip_values:
                        -   oid: MIKROTIK-MIB::mtxrGaugeUnit
                            op: '!='
                            value: 4

        dbm:
            data:
                -
                    oid: mtxrOpticalTable
                    value: mtxrOpticalTxPower
                    num_oid: '.1.3.6.1.4.1.14988.1.1.19.1.1.9.{{ $index }}'
                    divisor: 1000
                    descr: '{{ $mtxrOpticalName }} Tx'
                    index: 'mtxrOpticalTxPower.{{ $index }}'
                -
                    oid: mtxrOpticalTable
                    value: mtxrOpticalRxPower
                    num_oid: '.1.3.6.1.4.1.14988.1.1.19.1.1.10.{{ $index }}'
                    divisor: 1000
                    descr: '{{ $mtxrOpticalName }} Rx'
                    index: 'mtxrOpticalRxPower.{{ $index }}'
        state:
            data:
                -
                    oid: mtxrOpticalTable
                    value: mtxrOpticalRxLoss
                    num_oid: '.1.3.6.1.4.1.14988.1.1.19.1.1.3.{{ $index }}'
                    descr: '{{ $mtxrOpticalName }} Rx'
                    index: 'mtxrOpticalRxLoss.{{ $index }}'
                    state_name: mtxrOpticalRxLoss
                    states:
                        - { descr: no, graph: 1, value: 0, generic: 0 }
                        - { descr: yes, graph: 1, value: 1, generic: 2 }
                        - { descr: 'null', graph: 1, value: 2, generic: 3 }
                -
                    oid: mtxrOpticalTable
                    value: mtxrOpticalTxFault
                    num_oid: '.1.3.6.1.4.1.14988.1.1.19.1.1.4.{{ $index }}'
                    descr: '{{ $mtxrOpticalName }} Tx'
                    index: 'mtxrOpticalTxFault.{{ $index }}'
                    state_name: mtxrOpticalTxFault
                    states:
                        - { descr: no, graph: 1, value: 0, generic: 0 }
                        - { descr: yes, graph: 1, value: 1, generic: 2 }
                        - { descr: 'null', graph: 1, value: 2, generic: 3 }
                -
                    oid: mtxrPOETable
                    value: mtxrPOEStatus
                    num_oid: '.1.3.6.1.4.1.14988.1.1.15.1.1.3.{{ $index }}'
                    descr: '{{ $mtxrPOEName }} POE'
                    index: 'mtxrPOEStatus.{{ $index }}'
                    state_name: mtxrPOEStatus
                    states:
                        - { descr: 'disabled', graph: 1, value: 1, generic: 3 }
                        - { descr: 'waitingForLoad', graph: 1, value: 2, generic: 3 }
                        - { descr: 'poweredOn', graph: 1, value: 3, generic: 0 }
                        - { descr: 'overload', graph: 1, value: 4, generic: 2 }
                -
                    oid: MIKROTIK-MIB::mtxrGaugeTable
                    value: MIKROTIK-MIB::mtxrGaugeValue
                    num_oid: '.1.3.6.1.4.1.14988.1.1.3.100.1.{{ $index }}'
                    descr: MIKROTIK-MIB::mtxrGaugeName
                    index: 'mtxrGaugeStatus.{{ $index }}'
                    state_name: MIKROTIK-MIB::mtxrGaugeStatus
                    skip_values:
                        -   oid: MIKROTIK-MIB::mtxrGaugeUnit
                            op: '!='
                            value: 6
                    states:
                        - { value: 0, generic: 0, graph: 1, descr: 'ok' }
                        - { value: 1, generic: 2, graph: 1, descr: 'fail' }
                -
                    oid: mtxrWl60GConnected
                    num_oid: '.1.3.6.1.4.1.14988.1.1.1.8.1.4.{{ $index }}'
                    descr: Station Connected
                    index: 'mtxrWl60GConnected.{{ $index }}'
                    state_name: mtxrWl60GConnected
                    states:
                        - { value: 0, generic: 2, graph: 1, descr: 'disconnected' }
                        - { value: 1, generic: 0, graph: 1, descr: 'connected' }
                -
                    oid: mtxrWl60GMode
                    num_oid: '.1.3.6.1.4.1.14988.1.1.1.8.1.2.{{ $index }}'
                    descr: Mode
                    index: 'mtxrWl60GMode.{{ $index }}'
                    state_name: mtxrWl60GMode
                    states:
                        - { value: 0, generic: 0, graph: 1, descr: 'AP Bridge' }
                        - { value: 1, generic: 0, graph: 1, descr: 'Station Bridge' }
                        - { value: 2, generic: 0, graph: 1, descr: 'Sniff' }
                        - { value: 3, generic: 0, graph: 1, descr: 'Bridge' }
        power:
            data:
                -
                    oid: mtxrPOETable
                    value: mtxrPOEPower
                    num_oid: '.1.3.6.1.4.1.14988.1.1.15.1.1.6.{{ $index }}'
                    divisor: 10
                    descr: '{{ $mtxrPOEName }} POE'
                    index: 'mtxrPOEPower.{{ $index }}'
                -
                    oid: MIKROTIK-MIB::mtxrGaugeTable
                    value: MIKROTIK-MIB::mtxrGaugeValue
                    num_oid: '.1.3.6.1.4.1.14988.1.1.3.100.1.{{ $index }}'
                    descr: MIKROTIK-MIB::mtxrGaugeName
                    divisor: 10
                    index: 'mtxrGaugePower.{{ $index }}'
                    skip_values:
                        -   oid: MIKROTIK-MIB::mtxrGaugeUnit
                            op: '!='
                            value: 5
        fanspeed:
            data:
                -
                    oid: MIKROTIK-MIB::mtxrGaugeTable
                    value: MIKROTIK-MIB::mtxrGaugeValue
                    num_oid: '.1.3.6.1.4.1.14988.1.1.3.100.1.{{ $index }}'
                    descr: MIKROTIK-MIB::mtxrGaugeName
                    index: 'mtxrGuageFanspeed.{{ $index }}'
                    skip_values:
                        -   oid: MIKROTIK-MIB::mtxrGaugeUnit
                            op: '!='
                            value: 2
