mib: SCHLEIFENBAUER-DATABUS-MIB
modules:
    sensors:
        pre-cache:
            data:
                -
                    oid:
                        - sdbDevIdSerialNumber
                        - sdbDevCfMaximumLoad
        count:
            data:
                -
                    oid: sdbMgmtStsDuplicateDevices
                    num_oid: '.1.3.6.1.4.1.31034.12.1.1.1.1.4.{{ $index }}'
                    high_limit: '1'
                    entPhysicalIndex: 3
                    descr: 'Duplicate Device Addresses'
                    index: 'sdbMgmtStsDuplicateDevices.{{ $index }}'
                -
                    oid: sdbMgmtStsNewDevices
                    num_oid: '.1.3.6.1.4.1.31034.12.1.1.1.1.3.{{ $index }}'
                    warn_limit: 1
                    high_limit: 2
                    entPhysicalIndex: 4
                    descr: 'New Devices'
                    index: 'sdbMgmtStsNewDevices.{{ $index }}'
        current:
            data:
                -
                    oid: sdbDevInTable
                    value: sdbDevInActualCurrent
                    num_oid: '.1.3.6.1.4.1.31034.12.1.1.2.6.1.1.5.{{ $index }}'
                    warn_limit: sdbDevInMaxAmps
                    high_limit: '{{ $sdbDevCfMaximumLoad }} * 100'
                    entPhysicalIndex: '{{ $subindex0 }} * 10000 + 1000 + {{ $sdbDevInIndex }} * 10 + 2'
                    descr: '{{ $sdbDevIdSerialNumber }}-L{{ $sdbDevInIndex }} RMS Current'
                    index: '{{ $sdbDevIdSerialNumber }}-L{{ $sdbDevInIndex }}'
                    divisor: 100
        humidity:
            data:
                -
                    oid: sdbDevSnsTable
                    value: sdbDevSnsValue
                    num_oid: '.1.3.6.1.4.1.31034.12.1.1.2.8.2.1.3.{{ $index }}'
                    entPhysicalIndex: '{{ $subindex0 }} * 10000 + 3000 + {{ $sdbDevSnsIndex }} * 10'
                    descr: '{{ $sdbDevIdSerialNumber }} External Humidity'
                    index: '{{ $sdbDevIdSerialNumber }}-H{{ $sdbDevSnsIndex }}'
                    divisor: 100
                    skip_values:
                        -
                          oid: sdbDevSnsType
                          op: '!='
                          value: H
        power_consumed:
            data:
                -
                    oid: sdbDevInTable
                    value: sdbDevInKWhTotal
                    num_oid: '.1.3.6.1.4.1.31034.12.1.1.2.6.1.1.2.{{ $index }}'
                    low_limit: 0
                    high_limit: 16777215
                    entPhysicalIndex: '{{ $subindex0 }} * 10000 + 1000 + {{ $sdbDevInIndex }} * 10 + 4'
                    descr: '{{ $sdbDevIdSerialNumber }}-L{{ $sdbDevInIndex }} Lifetime kWh Total'
                    index: '{{ $sdbDevIdSerialNumber }}-L{{ $sdbDevInIndex }}'
        power_factor:
            data:
                -
                    oid: sdbDevInTable
                    value: sdbDevInPowerFactor
                    num_oid: '.1.3.6.1.4.1.31034.12.1.1.2.6.1.1.4.{{ $index }}'
                    low_limit: 0
                    high_limit: 1
                    entPhysicalIndex: '{{ $subindex0 }} * 10000 + 1000 + {{ $sdbDevInIndex }} * 10 + 5'
                    descr: '{{ $sdbDevIdSerialNumber }}-L{{ $sdbDevInIndex }} Power Factor'
                    index: '{{ $sdbDevIdSerialNumber }}-L{{ $sdbDevInIndex }}'
                    divisor: 10000
        power:
            data:
                -
                    oid: sdbDevInTable
                    value: sdbDevInPowerVoltAmpere
                    num_oid: '.1.3.6.1.4.1.31034.12.1.1.2.6.1.1.9.{{ $index }}'
                    entPhysicalIndex: '{{ $subindex0 }} * 10000 + 1000 + {{ $sdbDevInIndex }} * 10 + 3'
                    descr: '{{ $sdbDevIdSerialNumber }}-L{{ $sdbDevInIndex }} Apparent Power'
                    index: '{{ $sdbDevIdSerialNumber }}-L{{ $sdbDevInIndex }}'
        state:
            data:
                -
                    oid: sdbMgmtStsRingState
                    num_oid: '.1.3.6.1.4.1.31034.12.1.1.1.1.5.{{ $index }}'
                    entPhysicalIndex: 2
                    descr: 'Databus Ring State'
                    index: 'sdbMgmtStsRingState.{{ $index }}'
                    state_name: sdbMgmtStsRingState
                    states:
                        - { value: 0, generic: 2, graph: 0, descr: open }
                        - { value: 1, generic: 0, graph: 1, descr: closed }
        temperature:
            data:
                -
                    oid: sdbDevSnsTable
                    value: sdbDevSnsValue
                    num_oid: '.1.3.6.1.4.1.31034.12.1.1.2.8.2.1.3.{{ $index }}'
                    entPhysicalIndex: '{{ $subindex0 }} * 10000 + 3000 + {{ $sdbDevSnsIndex }} * 10'
                    descr: '{{ $sdbDevIdSerialNumber }} External Temperature'
                    index: '{{ $sdbDevIdSerialNumber }}-T{{ $sdbDevSnsIndex }}'
                    divisor: 100
                    skip_values:
                        -
                          oid: sdbDevSnsType
                          op: '!='
                          value: T
        voltage:
            data:
                -
                    oid: sdbDevInTable
                    value: sdbDevInActualVoltage
                    num_oid: '.1.3.6.1.4.1.31034.12.1.1.2.6.1.1.7.{{ $index }}'
                    entPhysicalIndex: '{{ $subindex0 }} * 10000 + 1000 + {{ $sdbDevInIndex }} * 10 + 1'
                    descr: '{{ $sdbDevIdSerialNumber }}-L{{ $sdbDevInIndex }} Voltage'
                    index: '{{ $sdbDevIdSerialNumber }}-L{{ $sdbDevInIndex }}'
                    divisor: 100
