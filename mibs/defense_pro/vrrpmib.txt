   VRRP-MIB DEFINITIONS ::= BEGIN

    IMPORTS
        MODULE-IDENTITY, OBJECT-TYPE,
        NOTIFICATION-TYPE, Counter32,
        Integer32, IpAddress                FROM SNMPv2-SMI

	mib-2,	PhysAddress          FROM RFC1213-MIB

	
        TEXTUAL-CONVENTION, RowStatus,
        MacAddress, TruthValue, TimeStamp   FROM SNMPv2-TC

 --   ifXEntry
 --       FROM IF-MIB
--
       DisplayString
                     FROM RFC1213-MIB

		InterfaceIndex
		            FROM IF-MIB
                 mgmt
                   FROM RFC1155-SMI;



    vrrpMIB  MODULE-IDENTITY
        LAST-UPDATED "9910050900Z"
        ORGANIZATION "IETF VRRP Working Group"
        CONTACT-INFO
               "Brian R. Jewell
        Postal: 3Com Corporation
                5400 BayFront Plaza
                Santa Clara, California 95052
        Tel:    +1 408 326 6173
        E-Mail: bjewell@3com.com"

		DESCRIPTION
            "This MIB describes objects used for managing Virtual Router
             Redundancy Protocol (VRRP) routers.Initial version as published in 
			 RFC xxxx (number to be assigned)."
        ::= { mib-2 68 }

			


   -- *******************************************************************
   --  Textual Conventions
   -- *******************************************************************

    VrId ::= TEXTUAL-CONVENTION
        STATUS       current
        DESCRIPTION
            "A number which, along with an interface index (ifIndex),
            serves to uniquely identify a virtual router on a given VRRP
            router. A set of one or more associated addresses is assigned
            to a VRID."
        SYNTAX      Integer32 (1..255)

   -- *******************************************************************
   --  VRRP MIB Groups
   -- *******************************************************************

    vrrpOperations      OBJECT IDENTIFIER ::= { vrrpMIB 1 }
    vrrpStatistics      OBJECT IDENTIFIER ::= { vrrpMIB 2 }
    vrrpConformance     OBJECT IDENTIFIER ::= { vrrpMIB 3 }


   -- *******************************************************************
   --  Start of MIB objects
   -- *******************************************************************

    vrrpNodeVersion  OBJECT-TYPE
        SYNTAX       Integer32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
           "This value identifies the particular version of the VRRP
            supported by this node."
        ::= { vrrpOperations 1 }

    vrrpNotificationCntl  OBJECT-TYPE
        SYNTAX       INTEGER {
            enabled     (1),
            disabled    (2)
        }
        MAX-ACCESS   read-write
        STATUS       current
        DESCRIPTION
           "Indicates whether the VRRP-enabled router will generate
            SNMP traps for events defined in this MIB. 'Enabled'
            results in SNMP traps; 'disabled', no traps are sent."
        DEFVAL { enabled }
        ::= { vrrpOperations 2 }



   -- *******************************************************************
   --  VRRP Operations Table
   -- *******************************************************************

    vrrpOperTable OBJECT-TYPE
        SYNTAX       SEQUENCE OF VrrpOperEntry
        MAX-ACCESS   not-accessible
        STATUS       current
        DESCRIPTION
            "Operations table for a VRRP router which consists of a
             sequence (i.e., one or more conceptual rows) of
             'vrrpOperEntry' items."
        ::= { vrrpOperations 3 }

    vrrpOperEntry OBJECT-TYPE
        SYNTAX       VrrpOperEntry
        MAX-ACCESS   not-accessible
        STATUS       current
        DESCRIPTION
            "An entry in the vrrpOperTable containing the operational
             characteristics of a virtual router. On a VRRP router,
             a given virtual router is identified by a combination
             of the IF index and VRID.

             Rows in the table cannot be modified unless the value
             of `vrrpOperAdminState' is `disabled' and the
             `vrrpOperState' has transitioned to `initialize'."

        INDEX    { vrrpOperIfIndex, vrrpOperVrId }
        ::= { vrrpOperTable 1 }





    VrrpOperEntry ::=
        SEQUENCE {
		     vrrpOperIfIndex
			    InterfaceIndex,
		    vrrpOperVrId
                VrId,
            vrrpOperVirtualMacAddr
                PhysAddress,
            vrrpOperState
                INTEGER,
            vrrpOperAdminState
                INTEGER,
            vrrpOperPriority
                Integer32,
            vrrpOperIpAddrCount
                Integer32,
            vrrpOperMasterIpAddr
                IpAddress,
            vrrpOperPrimaryIpAddr
                IpAddress,
            vrrpOperAuthType
                INTEGER,
            vrrpOperAuthKey
                DisplayString,
            vrrpOperAdvertisementInterval
                Integer32,
            vrrpOperPreemptMode
                TruthValue,
            vrrpOperVirtualRouterUpTime
                INTEGER,
            vrrpOperProtocol
                INTEGER,
            vrrpOperRowStatus
                RowStatus
    }

	vrrpOperIfIndex OBJECT-TYPE
        SYNTAX       InterfaceIndex
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            ""
        ::= { vrrpOperEntry 1 }

    vrrpOperVrId OBJECT-TYPE
        SYNTAX       VrId
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "This object contains the Virtual Router Identifier (VRID)."
        ::= { vrrpOperEntry 2 }





    vrrpOperVirtualMacAddr OBJECT-TYPE
        SYNTAX       PhysAddress
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The virtual MAC address of the virtual router. Although this
            object can be derived from the 'vrrpOperVrId' object, it is
            defined so that it is easily obtainable by a management
            application and can be included in VRRP-related SNMP traps."
        ::= { vrrpOperEntry 3 }

    vrrpOperState OBJECT-TYPE
        SYNTAX       INTEGER {
            initialize(1),
            backup(2),
            master(3)
        }
        MAX-ACCESS   read-only
        STATUS       current

        DESCRIPTION
            "The current state of the virtual router. This object has
            three defined values:

              - `initialize', which indicates that all the
                virtual router is waiting for a startup event.

              - `backup', which indicates the virtual router is
                monitoring the availability of the master router.

              - `master', which indicates that the virtual router
                is forwarding packets for IP addresses that are
                associated with this router.

            Setting the `vrrpOperAdminState' object (below) initiates
            transitions in the value of this object."
        ::= { vrrpOperEntry 4 }






    vrrpOperAdminState OBJECT-TYPE
        SYNTAX       INTEGER {
            up(1),
            down(2)
        }
        MAX-ACCESS   read-write
        STATUS       current
        DESCRIPTION
            "This object will enable/disable the virtual router
            function. Setting the value to `up', will transition
            the state of the virtual router from `initialize' to `backup'
            or `master', depending on the value of `vrrpOperPriority'.
            Setting the value to `down', will transition  the
            router from `master' or `backup' to `initialize'. State
            transitions may not be immediate; they sometimes depend on
            other factors, such as the interface (IF) state.

            The `vrrpOperAdminState' object must be set to `down' prior
            to modifying the other read-write objects in the conceptual
            row. The value of the `vrrpOperRowStatus' object (below)
            must be `active', signifying that the conceptual row
            is valid (i.e., the objects are correctly set),
            in order for this object to be set to `up'."
        DEFVAL    { down }
        ::= { vrrpOperEntry 5 }




    vrrpOperPriority OBJECT-TYPE
        SYNTAX       Integer32 (0..255)
        MAX-ACCESS   read-write
        STATUS       current
        DESCRIPTION
            "This object specifies the priority to be used for the
            virtual router master election process. Higher values imply
            higher priority.

            A priority of '0', although not settable, is sent by
            the master router to indicate that this router has ceased
            to particpate in VRRP and a backup virtual router should
            transition  to become a new master.

            A priority of 255 is used for the router that owns the
            associated IP address(es)."
        DEFVAL       { 100 }
        ::= { vrrpOperEntry 6 }

    vrrpOperIpAddrCount OBJECT-TYPE
        SYNTAX       Integer32 (0..255)
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The number of IP addresses that are associated with this
            virtual router. This number is equal to the number of rows
            in the vrrpAssoIpAddrTable that correspond to a given IF
            index/VRID pair."
        ::= { vrrpOperEntry 7 }

    vrrpOperMasterIpAddr OBJECT-TYPE
        SYNTAX       IpAddress
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The master router's real (primary) IP address. This is
            the IP address listed as the source in VRRP advertisement
            last received by this virtual router."
        ::= { vrrpOperEntry 8 }





    vrrpOperPrimaryIpAddr OBJECT-TYPE
        SYNTAX       IpAddress
        MAX-ACCESS   read-write
        STATUS       current
        DESCRIPTION
            "In the case where there is more than one IP address for
            a given `ifIndex', this object is used to specify the IP
            address that will become the `vrrpOperMasterIpAddr', should
            the virtual router transition from backup to master. If
            this object is set to 0.0.0.0, the IP address which is
            numerically lowest will be selected."
        DEFVAL       { '00000000'H } -- 0.0.0.0
        ::= { vrrpOperEntry 9 }

    vrrpOperAuthType OBJECT-TYPE
        SYNTAX       INTEGER {
            noAuthentication(1),       -- VRRP protocol exchanges are not
                                       -- authenticated.
            simpleTextPassword(2),     -- Exchanges are authenticated by a
                                       -- clear text password.
            ipAuthenticationHeader(3)  -- Exchanges are authenticated using
                                       -- the IP authentication header.
        }
        MAX-ACCESS   read-write
        STATUS       current
        DESCRIPTION
            "Authentication type used for VRRP protocol exchanges between
            virtual routers. This value of this object is the same for a
            given ifIndex."
        DEFVAL       { noAuthentication }
        ::= { vrrpOperEntry 10 }

    vrrpOperAuthKey OBJECT-TYPE
        SYNTAX       DisplayString (SIZE (0..8))
        MAX-ACCESS   read-write
        STATUS       current
        DESCRIPTION
            "The Authentication Key. This object is set according to
            the value of the 'vrrpOperAuthType' object
            ('simpleTextPassword' or 'ipAuthenticationHeader'). If the
            length of the value is less than 16 octets, the agent will
            left adjust and zero fill to 16 octets. The value of this
            object is the same for a given ifIndex.

            When read, vrrpOperAuthKey always returns an Octet String
            of length zero."
        ::= { vrrpOperEntry 11 }





    vrrpOperAdvertisementInterval OBJECT-TYPE
        SYNTAX       Integer32 (1..255)
        UNITS        "seconds"
        MAX-ACCESS   read-write
        STATUS       current
        DESCRIPTION
            "The time interval, in seconds, between sending
            advertisement messages. Only the master router sends
            VRRP advertisements."
        DEFVAL       { 1 }
        ::= { vrrpOperEntry 12 }

    vrrpOperPreemptMode OBJECT-TYPE
        SYNTAX       TruthValue
        MAX-ACCESS   read-write
        STATUS       current
        DESCRIPTION
            "Controls whether a higher priority virtual router will
            preempt a lower priority master."
        DEFVAL       { true }
        ::= { vrrpOperEntry 13 }

    vrrpOperVirtualRouterUpTime OBJECT-TYPE
        SYNTAX       INTEGER
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "This is the value of the `sysUpTime' object when this
            virtual router (i.e., the `vrrpOperState') transitioned
            out of `initialized'."
        ::= { vrrpOperEntry 14 }

    vrrpOperProtocol OBJECT-TYPE
        SYNTAX   INTEGER {
            ip (1),
            bridge (2),
            decnet (3),
            other (4)
        }
        MAX-ACCESS read-write
        STATUS     current
        DESCRIPTION
            "The particular protocol being controlled by this Virtual
            Router."
        DEFVAL { ip }
        ::= { vrrpOperEntry 15 }



    vrrpOperRowStatus OBJECT-TYPE
        SYNTAX       RowStatus
        MAX-ACCESS   read-write
        STATUS       current
        DESCRIPTION
            "The row status variable, used in accordance to installation
            and removal conventions for conceptual rows. The rowstatus of
            a currently active row in the vrrpOperTable is constrained
            by the operational state of the corresponding virtual router.
            When `vrrpOperRowStatus' is set to active(1), no other
            objects in the conceptual row, with the exception of
            `vrrpOperAdminState', can be modified. Prior to setting the
            `vrrpOperRowStatus' object from `active' to a different value,
            the `vrrpOperAdminState' object must be set to `down' and the
            `vrrpOperState' object be transitioned to `initialize'.

            To write a row in this table, a manager sets this object
            to either createAndGo(4) or createAndWait(5). Until instances
            of all corresponding columns are appropriately configured,
            the value of the corresponding instance of the `vrrpOperRowStatus'
            column will be read as notReady(3).

            In particular, a newly created row cannot be made active(1)
            until (minimally) the corresponding instance of
            `vrrpOperVrId' has been set and there is at least one active
            row in the `vrrpAssoIpAddrTable' defining an associated
            IP address for the virtual router."
        ::= { vrrpOperEntry 16 }


   -- *******************************************************************
   --  VRRP Associated IP Address Table
   -- *******************************************************************

    vrrpAssoIpAddrTable OBJECT-TYPE
        SYNTAX       SEQUENCE OF VrrpAssoIpAddrEntry
        MAX-ACCESS   not-accessible
        STATUS       current
        DESCRIPTION
            "The table of addresses associated with this virtual router."
        ::= { vrrpOperations 4 }



    vrrpAssoIpAddrEntry OBJECT-TYPE
        SYNTAX       VrrpAssoIpAddrEntry
        MAX-ACCESS   not-accessible
        STATUS       current
        DESCRIPTION
            "An entry in the table contains an IP address that is
            associated with a virtual router. The number of rows for
            a given ifIndex and VrId will equal the number of IP
            addresses associated (e.g., backed up) by the virtual
            router (equivalent to 'vrrpOperIpAddrCount').

            Rows in the table cannot be modified unless the value
            of `vrrpOperAdminState' is `disabled' and the
            `vrrpOperState' has transitioned to `initialize'."

        INDEX    { vrrpAssoIpIfIndex, vrrpAssoIpVrId, vrrpAssoIpAddr }
        ::= { vrrpAssoIpAddrTable 1 }

    VrrpAssoIpAddrEntry ::=
        SEQUENCE {
			vrrpAssoIpIfIndex 
			     InterfaceIndex,
	        vrrpAssoIpVrId
                VrId,
		    vrrpAssoIpAddr
                IpAddress,
            vrrpAssoIpAddrRowStatus
                RowStatus
    }

	vrrpAssoIpIfIndex OBJECT-TYPE
        SYNTAX       InterfaceIndex
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            ""
        ::= { vrrpAssoIpAddrEntry 1 }

	vrrpAssoIpVrId OBJECT-TYPE
        SYNTAX       VrId
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "This object contains the Virtual Router Identifier (VRID)."
        ::= { vrrpAssoIpAddrEntry 2 }



    vrrpAssoIpAddr OBJECT-TYPE
        SYNTAX       IpAddress
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The assigned IP addresses that a virtual router is
            responsible for backing up."
        ::= { vrrpAssoIpAddrEntry 3 }




    vrrpAssoIpAddrRowStatus OBJECT-TYPE
        SYNTAX       RowStatus
        MAX-ACCESS   read-write
        STATUS       current
        DESCRIPTION
            "The row status variable, used according to installation
            and removal conventions for conceptual rows. Setting this
            object to active(1) or createAndGo(4) results in the
            addition of an associated address for a virtual router.
            Destroying the entry or setting it to notInService(2)
            removes the associated address from the virtual router.
            The use of other values is implementation-dependent."
        ::= { vrrpAssoIpAddrEntry 4 }


   -- *******************************************************************
   --  VRRP Router Statistics
   -- *******************************************************************

    vrrpRouterChecksumErrors OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of VRRP packets received with an invalid
            VRRP checksum value."
        ::= { vrrpStatistics 1 }

    vrrpRouterVersionErrors OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of VRRP packets received with an unknown
            or unsupported version number."
        ::= { vrrpStatistics 2 }

    vrrpRouterVrIdErrors OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of VRRP packets received with an invalid
            VRID for this virtual router."
        ::= { vrrpStatistics 3 }








   -- *******************************************************************
   --  VRRP Router Statistics Table - To be copied later
   -- *******************************************************************

   
   END


