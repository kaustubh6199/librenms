[
  {
    "name": "Devices up\/down",
    "default": true,
    "sql": "macros.device_down = '1'"
  },
  {
    "name": "Device rebooted",
    "extra": "{\"count\": 1}",
    "default": true,
    "sql": "devices.uptime < '300' AND macros.device = '1'"
  },
  {
    "name": "BGP Session down",
    "extra": "{\"count\": 1}",
    "default": true,
    "sql": "bgpPeers.bgpPeerState != 'established' AND macros.device_up = '1'"
  },
  {
    "name": "BGP Session established",
    "extra": "{\"count\": 1}",
    "default": true,
    "sql": "bgpPeers.bgpPeerFsmEstablishedTime < '300' AND bgpPeers.bgpPeerState = 'established' AND macros.device_up = '1'"
  },
  {
    "name": "Port status up\/down",
    "extra": "{\"count\": 1}",
    "default": true,
    "sql": "macros.port_down = '1'"
  },
  {
    "name": "Port utilisation over threshold",
    "default": true,
    "sql": "macros.port_usage_perc >= 80 AND macros.port_up = '1' AND macros.port = '1'"
  },
  {
    "name": "Sensor over limit - Check Device Health Settings",
    "default": true,
    "sql": "sensors.sensor_current > sensors.sensor_limit AND sensors.sensor_alert = '1' AND macros.device_up = '1'"
  },
  {
    "name": "Sensor under limit - Check Device Health Settings",
    "default": true,
    "sql": "sensors.sensor_current < sensors.sensor_limit_low AND sensors.sensor_alert = '1' AND macros.device_up = '1'"
  },
  {
    "name": "Service up\/down",
    "default": true,
    "sql": "services.service_status != '0' AND macros.device_up = '1'"
  },
  {
    "name": "Wireless Sensor over limit",
    "default": true,
    "sql": "wireless_sensors.sensor_current >= wireless_sensors.sensor_limit AND wireless_sensors.sensor_alert = '1' AND macros.device_up = '1'"
  },
  {
    "name": "Wireless Sensor under limit",
    "default": true,
    "sql": "wireless_sensors.sensor_current <= wireless_sensors.sensor_limit_low AND wireless_sensors.sensor_alert = '1' AND macros.device_up = '1'"
  },
  {
    "name": "State Sensor Critical",
    "default": true,
    "sql": "macros.state_sensor_critical = 1"
  },
  {
    "name": "State Sensor Warning",
    "default": false,
    "sql": "macros.state_sensor_warning = 1"
  },
  {
    "name": "Quota bills over 75% used",
    "sql": "macros.bill_quota_over_quota >= '75'"
  },
  {
    "name": "CDR bills over 75% used",
    "sql": "macros.bill_cdr_over_quota >= '75'"
  },
  {
    "name": "IPSec tunnels down",
    "sql": "ipsec_tunnels.tunnel_status != 'active' AND macros.device_up = '1'"
  },
  {
    "name": "Poller is taking too long",
    "sql": "pollers.time_taken >= '250'"
  },
  {
    "name": "Cisco ASA connections over 5000",
    "sql": "macros.device_up = '1' AND devices.os = 'asa' AND ciscoASA.data > '5000'"
  },
  {
    "name": "Processor usage over 85%",
    "sql": "processors.processor_usage > '85' AND macros.device_up = '1'"
  },
  {
    "name": "Cisco ASA Primary unit changed to standby",
    "sql": "sensors.sensor_descr = 'Primary Unit.*' AND sensors.sensor_current = '10' AND sensors.sensor_prev = '9'"
  },
  {
    "name": "Port status change from up to down",
    "sql": "ports.ifOperStatus = 'down' AND ports.ifOperStatus_prev = 'up' AND macros.device_up = '1'"
  },
  {
    "name": "Interface Errors Rate greater than 100",
    "sql": "ports.ifOutErrors_rate >= '100' OR ports.ifInErrors_rate >= '100'"
  },
  {
    "name": "Device discovered within the last 60 minutes",
    "sql": "eventlog.type = 'discovery' AND eventlog.message REGEXP '@autodiscovered@' AND eventlog.datetime >= macros.past_60m"
  },
  {
    "name": "Too many wireless clients",
    "sql": "wireless_sensors.sensor_class = 'clients' AND wireless_sensors.sensor_current >= wireless_sensors.sensor_limit AND wireless_sensors.sensor_alert = '1' AND macros.device_up = '1'"
  },
  {
    "name": "Syslog, Authentication failure on Device",
    "sql": "syslog.timestamp >= macros.past_5m AND syslog.msg REGEXP '@authentication failure@'"
  },
  {
    "name": "Service warning",
    "sql": "services.service_status = '1'"
  },
  {
    "name": "Service critical",
    "sql": "services.service_status = '2'"
  },
  {
    "name": "Syslog, received Alert Priority Message",
    "sql": "syslog.timestamp >= macros.past_5m AND syslog.priority REGEXP 'alert'"
  },
  {
    "name": "Syslog, received Emergency Priority Message",
    "sql": "syslog.timestamp >= macros.past_5m AND syslog.priority REGEXP 'emergency'"
  },
  {
    "name": "Syslog, ARP table is full check on device ",
    "sql": "syslog.timestamp = macros.past_5m AND syslog.msg REGEXP '@arp table is full@'"
  },
  {
    "name": "APC UPS Battery Needs Replacement",
    "sql": "sensors.sensor_type = 'upsAdvBatteryReplaceIndicator' AND sensors.sensor_current = '2'"
  },
  {
    "name": "APC UPS Switched to Battery Power",
    "sql": "sensors.sensor_current = '3' AND sensors.sensor_type = 'upsBasicOutputStatus'"
  },
  {
    "name": "APC UPS in Hardware Failure Bypass Mode",
    "sql": "sensors.sensor_current = '10' AND sensors.sensor_type = 'upsBasicOutputStatus'"
  },
  {
    "name": "APC UPS in Emergency Static Bypass Mode",
    "sql": "sensors.sensor_current = '16' AND sensors.sensor_type = 'upsBasicOutputStatus'"
  },
  {
    "name": "APC UPS in Smart Trim Mode",
    "sql": "sensors.sensor_current = '12' AND sensors.sensor_type = 'upsBasicOutputStatus'"
  },
  {
    "name": "HP Procurve Bad Power Supply",
    "sql": "sensors.sensor_oid REGEXP '.1.3.6.1.4.1.11.2.14.11.1.2.6.1.4.[2-5]' AND sensors.sensor_current = '2'"
  },
  {
    "name": "HP Procurve Fan Fault",
    "sql": "sensors.sensor_oid = '.1.3.6.1.4.1.11.2.14.11.1.2.6.1.4.1' AND sensors.sensor_current = '2'"
  },
  {
    "name": "Sensor over limit with linked port",
    "sql": "sensors.sensor_current > sensors.sensor_limit AND sensors.sensor_alert = '1' AND macros.device_up = '1' AND macros.sensor_port_link = '1'"
  },
  {
    "name": "Sensor under limit with linked port",
    "sql": "sensors.sensor_current < sensors.sensor_limit_low AND sensors.sensor_alert = '1' AND macros.device_up = '1' AND macros.sensor_port_link = '1'"
  },
  {
    "name": "UPS is running on the bypass",
    "sql": "sensors.sensor_current = '4' AND sensors.sensor_type = 'upsOutputSourceState'"
  },
  {
    "name": "UPS is running on the battery",
    "sql": "sensors.sensor_current = '5' AND sensors.sensor_type = 'upsOutputSourceState'"
  },
  {
    "name": "UPS has a low battery",
    "sql": "sensors.sensor_current = '3' AND sensors.sensor_type = 'upsBatteryStatusState'"
  },
  {
    "name": "UPS has a depleted battery",
    "sql": "sensors.sensor_current = '4' AND sensors.sensor_type = 'upsBatteryStatusState'"
  },
  {
    "name": "UPS has a heavy load",
    "sql": "sensors.sensor_descr REGEXP 'Percentage load' AND sensors.sensor_current >= '90' AND sensors.sensor_type = 'rfc1628'"
  },
  {
    "name": "HPE iLo Server drive degraded\/failure",
    "sql": "sensors.sensor_current REGEXP '[3-4]' AND sensors.sensor_oid = '.1.3.6.1.4.1.232.3.2.5.1.1.37.'"
  },
  {
    "name": "HPE iLo Server Power Supply degraded\/failure",
    "sql": "sensors.sensor_current REGEXP '[3-4]' AND sensors.sensor_oid = '.1.3.6.1.4.1.232.6.2.9.3.1.4.'"
  },
  {
    "name": "HPE iLo Server Fan degraded\/failure",
    "sql": "sensors.sensor_current REGEXP '[3-4]' AND sensors.sensor_oid = '.1.3.6.1.4.1.232.6.2.6.7.1.9.'"
  },
  {
    "name": "HPE iLo Server CPU degraded\/failure",
    "sql": "sensors.sensor_current REGEXP '[3-4]' AND sensors.sensor_oid = '.1.3.6.1.4.1.232.1.2.2.1.1.6.'"
  },
  {
    "name": "HPE iLo Server Memory degraded\/failure",
    "sql": "sensors.sensor_current REGEXP '[3-4]' AND sensors.sensor_oid = '.1.3.6.1.4.1.232.6.2.14.13.1.20.'"
  },
  {
    "name": "Applications OS-Updates, New Updates Available",
    "sql": "applications.app_type = 'os-updates' AND applications.app_status >= '10'"
  },
  {
    "name": "HPE BladeSystem has a bad power supply",
    "sql": "devices.os = 'hpblmos' AND sensors.sensor_type = 'hpblmos_psustate' AND sensors.sensor_current = '[3-4]'"
  },
  {
    "name": "HPE BladeSystem has a bad fan",
    "sql": "devices.os = 'hpblmos' AND sensors.sensor_type = 'hpblmos_fanstate' AND sensors.sensor_current = '[3-4]'"
  },
  {
    "name": "AXIS camera has a failed temperature sensor",
    "sql": "devices.os = 'axiscam' AND sensors.sensor_type = 'tempSensorStatusState' AND sensors.sensor_current = '2'"
  },
  {
    "name": "RITTAL LCP has a failed status",
    "sql": "devices.os = 'rittal-lcp' AND sensors.sensor_type = 'cmcIIIUnitStatus' AND sensors.sensor_current = '2'"
  },
  {
    "name": "RITTAL LCP has an overloaded status",
    "sql": "devices.os = 'rittal-lcp' AND sensors.sensor_type = 'cmcIIIUnitStatus' AND sensors.sensor_current = '3'"
  },
  {
    "name": "Synology NAS has a failed status",
    "sql": "devices.os = 'dsm' AND sensors.sensor_type = 'systemStatusState' AND sensors.sensor_current = '2'"
  },
  {
    "name": "Synology NAS has a failed power status",
    "sql": "devices.os = 'dsm' AND sensors.sensor_type = 'powerStatusState' AND sensors.sensor_current = '2'"
  },
  {
    "name": "Synology NAS has a failed fan status",
    "sql": "devices.os = 'dsm' AND sensors.sensor_type = 'systemFanStatusState' AND sensors.sensor_current = '2'"
  },
  {
    "name": "Synology NAS has a failed CPU fan status",
    "sql": "devices.os = 'dsm' AND sensors.sensor_type = 'cpuFanStatusState' AND sensors.sensor_current = '2'"
  },
  {
    "name": "Synology NAS has a new upgrade available",
    "sql": "devices.os = 'dsm' AND sensors.sensor_type = 'upgradeAvailableState' AND sensors.sensor_current = '1'"
  },
  {
    "name": "Synology NAS has a bad RAID status",
    "sql": "devices.os = 'dsm' AND sensors.sensor_type = 'raidStatusState' AND sensors.sensor_current = '[11-12]'"
  },
  {
    "name": "Synology NAS has a bad disk status",
    "sql": "devices.os = 'dsm' AND sensors.sensor_type = 'diskStatusState' AND sensors.sensor_current = '[4-5]'"
  },
  {
    "name": "F5 appliance has a bad power supply",
    "sql": "devices.os = 'f5' AND sensors.sensor_type = 'sysChassisPowerSupplyStatus' AND sensors.sensor_current = '0'"
  },
  {
    "name": "F5 appliance has a bad fan",
    "sql": "devices.os = 'f5' AND sensors.sensor_type = 'sysChassisFanStatus' AND sensors.sensor_current = '0'"
  },
  {
    "name": "Cisco NX-OS device has a bad fan",
    "sql": "devices.os = 'nxos' AND sensors.sensor_type = 'cefcFanTrayOperStatus' AND sensors.sensor_current = '[3-4]'"
  },
  {
    "name": "Palo Alto Networks passive firewall changed to active",
    "sql": "devices.os = 'panos' & sensors.sensor_type = 'panSysHAState' AND sensors.sensor_current = '1' AND sensors.sensor_prev = '2'"
  },
  {
    "name": "Dell Server Raid Battery Failed\/Degraded",
    "sql": "sensors.sensor_current REGEXP '[2|6]' AND sensors.sensor_oid = '.1.3.6.1.4.1.674.10893.1.20.130.15.1.4.1'"
  },
  {
    "name": "Dell Server CPU Status Critical",
    "sql": "sensors.sensor_current = '2' AND sensors.sensor_oid = '.1.3.6.1.4.1.674.10892.1.1100.32.1.5'"
  },
  {
    "name": "Dell Server Disk Controller State Failed\/Degraded",
    "sql": "sensors.sensor_current REGEXP '[2|6]' AND sensors.sensor_oid = '.1.3.6.1.4.1.674.10893.1.20.130.1.1.5'"
  },
  {
    "name": "Dell Server Disk Array State Failed\/Degraded",
    "sql": "sensors.sensor_current REGEXP '[2|5]' AND sensors.sensor_oid = '.1.3.6.1.4.1.674.10893.1.20.130.4.1.4'"
  },
  {
    "name": "Dell Server PSU State Critical\/NonRecvoverable",
    "sql": "sensors.sensor_current REGEXP '[5|6]' AND sensors.sensor_oid = '.1.3.6.1.4.1.674.10892.1.600.12.1.5'"
  },
  {
    "name": "Dell Server Virtual Disk Failed\/Degraded",
    "sql": "sensors.sensor_current REGEXP '[2|6]' AND sensors.sensor_oid = '.1.3.6.1.4.1.674.10893.1.20.140.1.1.4'"
  },
  {
    "name": "Comware Fan Status failed",
    "sql": "sensors.sensor_current = '2' AND sensors.sensor_oid = '.1.3.6.1.4.1.25506.8.35.9.1.1.1.2'"
  },
  {
    "name": "Comware PSU status failed",
    "sql": "sensors.sensor_current = '2' AND sensors.sensor_oid = '.1.3.6.1.4.1.25506.8.35.9.1.2.1.2'"
  },
  {
    "name": "Cisco Fan Status failed ",
    "sql": "sensors.sensor_current = '9' AND sensors.sensor_oid = '.1.3.6.1.4.1.9.9.13.1.4.1.3'"
  },
  {
    "name": "Cisco PSU status failed",
    "sql": "sensors.sensor_current = '8' AND sensors.sensor_oid = '.1.3.6.1.4.1.9.9.13.1.5.1.3'"
  },
  {
    "name": "UBNT EdgeSwitch Chassis state failed",
    "sql": "sensors.sensor_current = '3' AND sensors.sensor_oid = '.1.3.6.1.4.1.4413.1.1.43.1.15.1.2.1'"
  },
  {
    "name": "Dell iDRAC Virtual Disk Failed\/Degraded",
    "sql": "sensors.sensor_current REGEXP '[3|4]' AND sensors.sensor_oid = '.1.3.6.1.4.1.674.10892.5.5.1.20.140.1.1.4'"
  },
  {
    "name": "Dell iDRAC Processor Status Critical",
    "sql": "sensors.sensor_current REGEXP '5' AND sensors.sensor_oid = '.1.3.6.1.4.1.674.10892.5.4.1100.30.1.5'"
  },
  {
    "name": "Dell iDRAC Memory Status Critical",
    "sql": "sensors.sensor_current REGEXP '5' AND sensors.sensor_oid = '.1.3.6.1.4.1.674.10892.5.4.1100.50.1.5'"
  },
  {
    "name": "Dell iDRAC Voltage Probe Status Failed",
    "sql": "sensors.sensor_current REGEXP '10' AND sensors.sensor_oid = '.1.3.6.1.4.1.674.10892.5.4.600.20.1.5'"
  },
  {
    "name": "Dell iDRAC Amperage Probe Status Failed",
    "sql": "sensors.sensor_current REGEXP '10' AND sensors.sensor_oid = '.1.3.6.1.4.1.674.10892.5.4.600.30.1.5'"
  },
  {
    "name": "Dell iDRAC Battery Status Failed",
    "sql": "sensors.sensor_current REGEXP '10' AND sensors.sensor_oid = '.1.3.6.1.4.1.674.10892.5.4.600.50.1.5'"
  },
  {
    "name": "Dell iDRAC Global System Status Critical/NonRecoverable",
    "sql": "sensors.sensor_current REGEXP '[5|6]' AND sensors.sensor_oid = '.1.3.6.1.4.1.674.10892.2.2.1'"
  }
]
